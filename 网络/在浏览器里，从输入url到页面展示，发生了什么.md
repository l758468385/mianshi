## 从输入URL到页面展示，中间发生了什么？

1.浏览器会判断我们输入的关键字是 URL还是 搜索内容，如果是搜索内容，地址栏会使用默认搜索引擎去搜索关键字，

2.如果是URL，浏览器会去解析这个域名，一般会先去本地硬盘的hosts文件中查找有没有和输入的URL匹配的规则，如果有就使用hosts文件里面的IP地址，如果在本地hosts文件中没有找到相应的IP地址，浏览器就会发出一个DNS请求到本地DNS服务器，本地DNS服务器一般就是我们的电信运营商比如中国电信、中国移动之类的，本地DNS会查询自己的缓存记录，如果缓存中有匹配上，就可以直接返回对应的IP地址，如果没有本地DNS服务器还要向根域名服务器进行查询，根DNS服务器并没有记录具体的域名与IP之间的对应关系，他只会告诉本地的DNS服务器，你需要到哪个顶级域名服务器上去查询，给出顶级域服务器地址后，本地DNS服务器接着向顶级域服务器发出请求，比如是.com域服务器，.com域服务器接收到请求后，也不会直接返回对应的IP地址，而是告诉本地DNS服务器对应的权威域服务器地址，最后本地DNS服务器向着权威服务器例如163.com发出请求，这时候就能收到一个对应的IP地址。

3.拿到域名对应的IP地址后，会与服务器建立TCP连接，

#### TCP三次握手：

知识扩展：

SYN：同步位 ======> SYN=1,表示进行一个连接请求

ACK：确认位 ======> ACK=1表示确认有效，ACK=0表示确认无效

ack：确认号 ======>对方发送序号+1

seq：序号 

​	

- 第一次握手：客户端将同步位SYN设置为1，随机产生一个值为seq=x（x的取值范围=1234567，随机的）的数据包到服务器，客户端进入SYN_SENT状态，等待服务端确认
- 第二次握手：服务器收到数据包后由SYN=1知道客户端请求建立连接，服务器将标志位SYN和ACK都设置为1，ack=x+1,seq=y,并将数据包发送给客户端确认连接
- 第三次握手：客户端收到确认后，检查ack是否等于x+1,ACK是否为1，如果正确，将ACK=1，ack=y+1,seq=x+1，发送数据包给客户端，服务器检查ack是否是y+1，ACK是否为1，都正确则连接成功

![img](https://img-blog.csdn.net/20180717202520531?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4OTUwMzE2/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)



#### 四次挥手

扩展知识：

FIN=1 意思要断开连接，并且客户端不再向服务器发送数据

- 第一次挥手：客户端发送一个FIN=1，序列号seq=u（等于前面已经传过来的数据最后一个字节的需要+1）

- 第二次挥手：服务端收到请求，发出ACK=1，ack=u+1，并且带上自己的序列号seq=v，此时服务器就进入了半关闭状态，就是客户端已经没有数据要发送了，但是服务器如果要发数据，客户端依然要接受；

- 第三次挥手：服务器将最后的数据发送完毕后，就向客户端发送ACK=1，FIN=1，ack=u+1,因为此间服务器可能又发送了一些数据，所以seq=w

- 第四次挥手：客户端收到数据包后，发送ACK=1,ack=w+1，seq=u+1,ack=w+1数据包，这样客户端就进入了等待状态，这个时候tcp连接还没有释放，进入一个等待2MSL后（MSL叫做最大报文生存时间）客户端才会进入关闭完全关闭状态，服务器也进入完全关闭状态，以上四次挥手结束

  ![img](https://img-blog.csdn.net/20180717204202563?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4OTUwMzE2/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

  